import e,{createContext as t,useContext as r,useEffect as n,useState as a,useRef as i,Fragment as o}from"react";function l(e,t){var r,n;if("function"==typeof t)void 0!==(n=t(e))&&(e=n);else if(Array.isArray(t))for(r=0;r<t.length;r++)void 0!==(n=t[r](e))&&(e=n);return e}function u(e,t){return"-"===e[0]&&Array.isArray(t)&&/^-\d+$/.test(e)?t.length+parseInt(e,10):e}function c(e){return"[object Object]"===Object.prototype.toString.call(e)}function s(e){return Object(e)===e}function f(e){return 0===Object.keys(e).length}function p(e,t){return e.indexOf("[")>=0&&(e=e.replace(/\[/g,".").replace(/]/g,"")),e.split(t)}function h(e,t,r){if(!(this instanceof h))return new h(e,t,r);void 0===t&&(t=!1),void 0===r&&(r=!0),this.separator=e||".",this.override=t,this.useArray=r,this.keepArray=!1,this.cleanup=[]}var d=new h(".",!1,!0);function m(e){return function(){return d[e].apply(d,arguments)}}h.prototype._fill=function(e,t,r,n){var a=e.shift();if(e.length>0){if(t[a]=t[a]||(this.useArray&&function(e){return/^\d+$/.test(e)}(e[0])?[]:{}),!s(t[a])){if(!this.override){if(!s(r)||!f(r))throw new Error("Trying to redefine `"+a+"` which is a "+typeof t[a]);return}t[a]={}}this._fill(e,t[a],r,n)}else{if(!this.override&&s(t[a])&&!f(t[a])){if(!s(r)||!f(r))throw new Error("Trying to redefine non-empty obj['"+a+"']");return}t[a]=l(r,n)}},h.prototype.object=function(e,t){var r=this;return Object.keys(e).forEach(function(n){var a=void 0===t?null:t[n],i=p(n,r.separator).join(r.separator);-1!==i.indexOf(r.separator)?(r._fill(i.split(r.separator),e,e[n],a),delete e[n]):r.override&&(e[n]=l(e[n],a))}),e},h.prototype.str=function(e,t,r,n){return-1!==e.indexOf(this.separator)?this._fill(e.split(this.separator),r,t,n):r.hasOwnProperty(e)&&!this.override||(r[e]=l(t,n)),r},h.prototype.pick=function(e,t,r){var n,a,i,o,l;for(a=p(e,this.separator),n=0;n<a.length;n++){if(o=u(a[n],t),!(t&&"object"==typeof t&&o in t))return;if(n===a.length-1)return r?(i=t[o],delete t[o],Array.isArray(t)&&(l=a.slice(0,-1).join("."),-1===this.cleanup.indexOf(l)&&this.cleanup.push(l)),i):t[o];t=t[o]}return r&&Array.isArray(t)&&(t=t.filter(function(e){return void 0!==e})),t},h.prototype.remove=function(e,t){var r;if(this.cleanup=[],Array.isArray(e)){for(r=0;r<e.length;r++)this.pick(e[r],t,!0);return this._cleanup(t),t}return this.pick(e,t,!0)},h.prototype._cleanup=function(e){var t,r,n,a;if(this.cleanup.length){for(r=0;r<this.cleanup.length;r++)t=(t=(a=(n=this.cleanup[r].split(".")).splice(0,-1).join("."))?this.pick(a,e):e)[n[0]].filter(function(e){return void 0!==e}),this.set(this.cleanup[r],t,e);this.cleanup=[]}},h.prototype.del=h.prototype.remove,h.prototype.move=function(e,t,r,n,a){return"function"==typeof n||Array.isArray(n)?this.set(t,l(this.pick(e,r,!0),n),r,a):(a=n,this.set(t,this.pick(e,r,!0),r,a)),r},h.prototype.transfer=function(e,t,r,n,a,i){return"function"==typeof a||Array.isArray(a)?this.set(t,l(this.pick(e,r,!0),a),n,i):(i=a,this.set(t,this.pick(e,r,!0),n,i)),n},h.prototype.copy=function(e,t,r,n,a,i){return"function"==typeof a||Array.isArray(a)?this.set(t,l(JSON.parse(JSON.stringify(this.pick(e,r,!1))),a),n,i):(i=a,this.set(t,this.pick(e,r,!1),n,i)),n},h.prototype.set=function(e,t,r,n){var a,i,o,l;if(void 0===t)return r;for(o=p(e,this.separator),a=0;a<o.length;a++){if(l=o[a],a===o.length-1)if(n&&c(t)&&c(r[l]))for(i in t)t.hasOwnProperty(i)&&(r[l][i]=t[i]);else if(n&&Array.isArray(r[l])&&Array.isArray(t))for(var u=0;u<t.length;u++)r[o[a]].push(t[u]);else r[l]=t;else r.hasOwnProperty(l)&&(c(r[l])||Array.isArray(r[l]))||(/^\d+$/.test(o[a+1])?r[l]=[]:r[l]={});r=r[l]}return r},h.prototype.transform=function(e,t,r){return t=t||{},r=r||{},Object.keys(e).forEach(function(n){this.set(e[n],this.pick(n,t),r)}.bind(this)),r},h.prototype.dot=function(e,t,r){return t=t||{},r=r||[],Object.keys(e).forEach(function(n){if(s(e[n])&&(c(e[n])&&!f(e[n])||Array.isArray(e[n])&&!this.keepArray&&0!==e[n].length))return this.dot(e[n],t,r.concat(n));t[r.concat(n).join(this.separator)]=e[n]}.bind(this)),t},h.pick=m("pick"),h.move=m("move"),h.transfer=m("transfer"),h.transform=m("transform"),h.copy=m("copy"),h.object=m("object"),h.str=m("str"),h.set=m("set"),h.del=h.remove=m("remove"),h.dot=m("dot"),["override","overwrite"].forEach(function(e){Object.defineProperty(h,e,{get:function(){return d.override},set:function(e){d.override=!!e}})}),["useArray","keepArray"].forEach(function(e){Object.defineProperty(h,e,{get:function(){return d[e]},set:function(t){d[e]=t}})}),h._process=l;var y=h,v=t({initialData:{},errors:{},scopePath:"",registerField:function(){},unregisterField:function(){}});function b(e){var t=r(v),a=t.initialData,i=t.errors,o=t.scopePath,l=t.unregisterField,u=t.registerField,c=o?o+"."+e:e;n(function(){return function(){return l(c)}},[c]);var s=y.pick(c,a),f=i[c];return{fieldName:c,registerField:u,defaultValue:s,error:f}}var g=function(){return(g=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function E(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&(r[n[a]]=e[n[a]])}return r}function k(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}function w(t){var r=t.initialData,n=void 0===r?{}:r,i=t.children,o=t.schema,l=t.context,u=void 0===l?{}:l,c=t.onSubmit,s=E(t,["initialData","children","schema","context","onSubmit"]),f=a({}),p=f[0],h=f[1],d=a([]),m=d[0],b=d[1];function w(e){void 0===e&&(e={}),m.forEach(function(t){var r=t.name,n=t.ref,a=t.path,i=t.clearValue;return i?i(n,e[r]):y.set(a,e[r]?e[r]:"",n)})}return e.createElement(v.Provider,{value:{initialData:n,errors:p,scopePath:"",registerField:function(e){b(function(t){return t.concat([e])})},unregisterField:function(e){b(function(t){return t.filter(function(t){return t.name!==e})})}}},e.createElement("form",g({},s,{"data-testid":"form",onSubmit:function(e){return t=this,r=void 0,a=function(){var t,r,n;return k(this,function(a){switch(a.label){case 0:e.preventDefault(),t=function(){var e={};return m.forEach(function(t){var r=t.name,n=t.ref,a=t.path,i=t.parseValue,o=y.pick(a,n);e[r]=i?i(n):o}),y.object(e),e}(),a.label=1;case 1:return a.trys.push([1,4,,5]),o?[4,o.validate(t,{abortEarly:!1,stripUnknown:!0,context:u})]:[3,3];case 2:a.sent(),t=o.cast(t,{stripUnknown:!0,context:u}),a.label=3;case 3:return h({}),c(t,{resetForm:w}),[3,5];case 4:if(r=a.sent(),n={},!r.inner)throw r;return r.inner.forEach(function(e){n[e.path]=e.message}),h(n),[3,5];case 5:return[2]}})},new((n=void 0)||(n=Promise))(function(e,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function l(e){try{u(a.throw(e))}catch(e){i(e)}}function u(t){t.done?e(t.value):new n(function(e){e(t.value)}).then(o,l)}u((a=a.apply(t,r||[])).next())});var t,r,n,a}}),i))}function A(t){var n=t.path,a=t.children,i=r(v),o=i.scopePath,l=E(i,["scopePath"]);return e.createElement(v.Provider,{value:g({},l,{scopePath:o.concat(o?"."+n:n)})},a)}function O(t){var r=t.name,a=t.label,o=t.multiline,l=void 0!==o&&o,u=E(t,["name","label","multiline"]),c=i(null),s=b(r),f=s.fieldName,p=s.registerField,h=s.defaultValue,d=s.error;n(function(){c.current&&p({name:f,ref:c.current,path:"value"})},[c.current,f]);var m=g({},u,{ref:c,id:f,name:f,"aria-label":f,defaultValue:h});return e.createElement(e.Fragment,null,a&&e.createElement("label",{htmlFor:f},a),l?e.createElement("textarea",g({},m)):e.createElement("input",g({},m)),d&&e.createElement("span",null,d))}function j(t){return n(function(){console.warn("Textarea will be deprecated in the next major unform release. Please use <Input multiline /> instead")},[]),e.createElement(O,g({},t,{multiline:!0}))}function F(t){var r=t.name,a=t.label,o=t.placeholder,l=t.defaultValue,u=t.options,c=E(t,["name","label","placeholder","defaultValue","options"]),s=i(null),f=b(r),p=f.fieldName,h=f.registerField,d=f.defaultValue,m=f.error;return n(function(){s.current&&h({name:p,ref:s.current,path:"value"})},[s.current,p]),e.createElement(e.Fragment,null,a&&e.createElement("label",{htmlFor:p},a),e.createElement("select",g({},c,{multiple:!1,id:p,name:p,defaultValue:d||l,"aria-label":p,ref:s}),e.createElement("option",{value:l,disabled:!0,hidden:!0},o),u.map(function(t){var r=t.id,n=t.title;return e.createElement("option",{key:r,value:r},n)})),m&&e.createElement("span",null,m))}function P(t){var r=t.name,o=t.label,l=t.onStartProgress,u=E(t,["name","label","onStartProgress"]),c=i(null),s=b(r),f=s.fieldName,p=s.registerField,h=s.defaultValue,d=s.error,m=a(h),y=m[0],v=m[1];n(function(){c.current&&p({name:f,ref:c.current,path:"dataset.file",clearValue:function(e){e.value="",v("")}})},[c.current,f]);var k=g({},u,{ref:c,id:f,name:f,"aria-label":f});return e.createElement(e.Fragment,null,o&&e.createElement("label",{htmlFor:f},o),e.createElement("input",g({},k,{type:"file",onChange:function(e){var t=new FileReader;t.onload=function(e){var t=e.target.result;v(t)},t.onprogress=function(e){var t=e.loaded,r=void 0===t?0:t,n=e.total;l&&l(r/(void 0===n?0:n)*100,e)};var r=e.target.files;r&&t.readAsDataURL(r[0])},"data-file":y})),d&&e.createElement("span",null,d))}function x(t){var r=t.name,a=t.label,o=E(t,["name","label"]),l=i(null),u=b(r),c=u.fieldName,s=u.registerField,f=u.defaultValue,p=u.error,h=function(e){return e.checked};n(function(){l.current&&s({name:c,ref:l.current,path:"",parseValue:h,clearValue:function(e){e.checked=!1}})},[l.current,c]);var d=g({},o,{ref:l,id:c,name:c,type:"checkbox","aria-label":c,defaultChecked:f});return e.createElement(e.Fragment,null,e.createElement("input",g({},d)),a&&e.createElement("label",{htmlFor:c},a),p&&e.createElement("span",null,p))}function V(t){var r=t.name,a=t.options,l=t.multiple,u=E(t,["name","options","multiple"]),c=b(r),s=c.fieldName,f=c.registerField,p=c.defaultValue,h=c.error,d=i([]),m=l?"checkbox":"radio",y=function(e){return!!p&&("string"==typeof p?[p].includes(e):Array.from(p).includes(e))},v=function(e){var t=e.filter(function(e){return e.checked}).map(function(e){return e.value});return l?t:t[0]};return n(function(){d.current=d.current.slice(0,a.length),f({name:s,path:"",ref:d.current,parseValue:v,clearValue:function(e){e.forEach(function(e){e.checked=!1})}})},[s]),e.createElement(o,null,a.map(function(t,r){var n=t.value,a=t.label,i=s+"-"+n;return e.createElement(o,{key:i},e.createElement("input",g({},u,{ref:function(e){d.current[r]=e},type:m,id:i,name:s,"aria-label":i,value:n,defaultChecked:y(n)})),a&&e.createElement("label",{htmlFor:i},a))}),h&&e.createElement("span",null,h))}F.defaultProps={placeholder:"",defaultValue:""};export{x as Check,V as Choice,P as FileInput,w as Form,O as Input,A as Scope,F as Select,j as Textarea,b as useField};
//# sourceMappingURL=index.es.js.map
